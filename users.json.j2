// Firefox Hardening by Ansible Role

{% if firefox_policies.disable_javascript %}
user_pref("javascript.enabled", false);
{% endif %}

{% if firefox_policies.block_autoplay %}
user_pref("media.autoplay.default", 5);  // Block all autoplay
user_pref("media.autoplay.blocking_policy", 2);
{% endif %}

{% if firefox_policies.disable_plugins %}
user_pref("plugin.scan.plid.all", false);
user_pref("plugins.enumerable_names", "");
user_pref("plugin.disable", true);
{% endif %}

{% if firefox_policies.disable_popups %}
user_pref("dom.popup_maximum", 0);
user_pref("dom.disable_open_during_load", true);
{% endif %}

{% if firefox_policies.block_executables %}
user_pref("browser.download.manager.scanWhenDone", false);
user_pref("browser.download.folderList", 2);
user_pref("browser.helperApps.neverAsk.saveToDisk", "application/x-msdownload, application/x-msdos-program, application/x-exe, application/exe, application/x-exe, application/x-winexe, application/msdos-windows, application/x-msdownload, application/octet-stream");
user_pref("browser.helperApps.neverAsk.openFile", "application/x-msdownload, application/x-msdos-program");
{% endif %}

{% if firefox_policies.enable_tracking_protection %}
user_pref("privacy.trackingprotection.enabled", true);
user_pref("privacy.trackingprotection.pbmode.enabled", true);
{% endif %}

// Other security-minded settings
user_pref("network.dns.disablePrefetch", true);
user_pref("network.prefetch-next", false);
user_pref("network.http.sendRefererHeader", 1);
user_pref("network.http.referer.trimmingPolicy", 2);
user_pref("network.http.referer.XOriginPolicy", 2);
user_pref("security.mixed_content.block_active_content", true);
user_pref("security.fileuri.strict_origin_policy", true);
